import{a as F}from"./jsx-runtime-BQA5H8uj.js";import{r as e}from"./index-CBqU2yxZ.js";import{a as b,u as H}from"./use-constant-GMTLHggF.js";import{a as O}from"./frame-COx4tYGr.js";const K=e.createContext(null),U=e.createContext({});function w(){const s=e.useContext(K);if(s===null)return[!0,null];const{isPresent:n,onExitComplete:t,register:r}=s,f=e.useId();return e.useEffect(()=>r(f),[]),!n&&t?[!1,()=>t&&t(f)]:[!0]}function S(){const s=e.useRef(!1);return b(()=>(s.current=!0,()=>{s.current=!1}),[]),s}function L(){const s=S(),[n,t]=e.useState(0),r=e.useCallback(()=>{s.current&&t(n+1)},[n]);return[e.useCallback(()=>O.postRender(r),[r]),n]}class _ extends e.Component{getSnapshotBeforeUpdate(n){const t=this.props.childRef.current;if(t&&n.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function j({children:s,isPresent:n}){const t=e.useId(),r=e.useRef(null),f=e.useRef({width:0,height:0,top:0,left:0});return e.useInsertionEffect(()=>{const{width:u,height:c,top:l,left:C}=f.current;if(n||!r.current||!u||!c)return;r.current.dataset.motionPopId=t;const p=document.createElement("style");return document.head.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${c}px !important;
            top: ${l}px !important;
            left: ${C}px !important;
          }
        `),()=>{document.head.removeChild(p)}},[n]),e.createElement(_,{isPresent:n,childRef:r,sizeRef:f},e.cloneElement(s,{ref:r}))}const I=({children:s,initial:n,isPresent:t,onExitComplete:r,custom:f,presenceAffectsLayout:u,mode:c})=>{const l=H(A),C=e.useId(),p=e.useMemo(()=>({id:C,initial:n,isPresent:t,custom:f,onExitComplete:o=>{l.set(o,!0);for(const i of l.values())if(!i)return;r&&r()},register:o=>(l.set(o,!1),()=>l.delete(o))}),u?void 0:[t]);return e.useMemo(()=>{l.forEach((o,i)=>l.set(i,!1))},[t]),e.useEffect(()=>{!t&&!l.size&&r&&r()},[t]),c==="popLayout"&&(s=e.createElement(j,{isPresent:t},s)),e.createElement(K.Provider,{value:p},s)};function A(){return new Map}function B(s){return e.useEffect(()=>()=>s(),[])}const y=s=>s.key||"";function N(s,n){s.forEach(t=>{const r=y(t);n.set(r,t)})}function V(s){const n=[];return e.Children.forEach(s,t=>{e.isValidElement(t)&&n.push(t)}),n}const q=({children:s,custom:n,initial:t=!0,onExitComplete:r,exitBeforeEnter:f,presenceAffectsLayout:u=!0,mode:c="sync"})=>{const l=e.useContext(U).forceRender||L()[0],C=S(),p=V(s);let o=p;const i=e.useRef(new Map).current,R=e.useRef(o),h=e.useRef(new Map).current,g=e.useRef(!0);if(b(()=>{g.current=!1,N(p,h),R.current=o}),B(()=>{g.current=!0,h.clear(),i.clear()}),g.current)return e.createElement(e.Fragment,null,o.map(a=>e.createElement(I,{key:y(a),isPresent:!0,initial:t?void 0:!1,presenceAffectsLayout:u,mode:c},a)));o=[...o];const x=R.current.map(y),T=p.map(y),E=x.length;for(let a=0;a<E;a++){const d=x[a];T.indexOf(d)===-1&&!i.has(d)&&i.set(d,void 0)}return c==="wait"&&i.size&&(o=[]),i.forEach((a,d)=>{if(T.indexOf(d)!==-1)return;const M=h.get(d);if(!M)return;const P=x.indexOf(d);let m=a;if(!m){const $=()=>{i.delete(d);const z=Array.from(h.keys()).filter(v=>!T.includes(v));if(z.forEach(v=>h.delete(v)),R.current=p.filter(v=>{const k=y(v);return k===d||z.includes(k)}),!i.size){if(C.current===!1)return;l(),r&&r()}};m=e.createElement(I,{key:y(M),isPresent:!1,onExitComplete:$,custom:n,presenceAffectsLayout:u,mode:c},M),i.set(d,m)}o.splice(P,0,m)}),o=o.map(a=>{const d=a.key;return i.has(d)?a:e.createElement(I,{key:y(a),isPresent:!0,presenceAffectsLayout:u,mode:c},a)}),e.createElement(e.Fragment,null,i.size?o:o.map(a=>e.cloneElement(a)))},D=({children:s,in:n,unmount:t,initial:r=!0,...f})=>{const u=e.useRef(),c=e.useRef();return e.useEffect(()=>{clearTimeout(n?c.current:u.current)},[n]),F(q,{children:(n||!t)&&F(G,{enterTimeout:u,exitTimeout:c,in:n,initial:r,...f,children:s})})},G=({children:s,timeout:n=0,enterTimeout:t,exitTimeout:r,onEnter:f,onEntered:u,onExit:c,onExited:l,initial:C,nodeRef:p,in:o})=>{const[i,R]=e.useState(C?"exited":"entered"),[h,g]=w(),[x,T]=e.useState(!C),E=typeof n=="object",a=e.useRef(null),d=p||a,M=x&&o?h:!1;return e.useEffect(()=>{var m;if(x||!o)return;const P=E?n.enter:n;clearTimeout(t.current),clearTimeout(r.current),T(!0),R("entering"),f==null||f(),(m=d.current)==null||m.offsetHeight,t.current=setTimeout(()=>{R("entered"),u==null||u()},P)},[f,u,n,i,o]),e.useEffect(()=>{var m;if(h&&o)return;const P=E?n.exit:n;clearTimeout(t.current),clearTimeout(r.current),R("exiting"),c==null||c(),(m=d.current)==null||m.offsetHeight,r.current=setTimeout(()=>{R("exited"),g==null||g(),l==null||l()},P)},[h,c,g,n,l,o]),s({visible:M,status:i,nodeRef:d})};D.__docgenInfo={description:"A lightweight Framer Motion `AnimatePresence` implementation of\n`react-transition-group` to be used for simple vanilla css transitions",methods:[],displayName:"Transition",props:{initial:{defaultValue:{value:"true",computed:!1},required:!1}}};export{D as T};
